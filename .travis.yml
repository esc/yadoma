language: python
cache: pip

python:
  - "3.5"

before_install:
  - git fetch --unshallow || true

install:
  - pip install -U pip
  - pip install --pre pybuilder
  - pyb -X install_dependencies

script:
  - pyb -X

before_deploy:
  - pyb -X package

deploy:
  provider: pypi
  user: esc
  distributions: sdist
  skip_cleanup: true
  password:
    secure: "Rrp7yAFhIiQGzh1d/i5aKzORbc7ub8vMQ3J9zRY0i8/r6bcZ0PJrCDLIe+hTO4VHwtIGtrXMgRPl+nl7rrAWXSwUKRm/Cq+LyEED/Y1XnrD2gSarRfpNVSLMbrU5BUOu5uRDdu4R5KXfBrIOqAxRX/hlNTMQuhQo71h5E5YYQXPahXzCfIcb/nqIbkAHW3nGUN9GekS8f2j0XaC9IszYjSynJnyg5vWoikU2qRvxFHcxQz0HreGbd7FS0CzhbZLUHMGX3Dfoj2FAHyhPh1Spmt0+nQauNVHwLatQzhQlC+S4zerRpT7N5S0bxXxMJEuok9GdOTCU0yyQ1MxcFi94K+PBaEBmgfq4Y0FxdFyOmJp9myu7/UsXhWH7YWEUpLsflNtJtANfECZSHyxZe9ClGNSO5N5t/NmAf0ogPPmwHxPKsjp38GBVFv3QlDvv9iMnYZY7H6s9NiVlKYgfFfihJYyDtcPaPXgtieRdcE6LH8jkL1BxGVp0PGvJyo1NrPdl2ipJxiEkt0ud76HHDaFnREV5lk/+4uV1yEMunGpsDKZzhpvQwvm08XwiqX0Lt5DNTPk1NQhBsZnbyuOiG+DB3zVy52HFHDnOK1TpHoOgRcfiDohkM9E6NtBMNPbvBOpKH9B2hjOC8rOLWyr8yETPP74Rk5x9JvXwMKd2RPZ4MU4="
  on:
    repo: esc/yadoma
    python: '3.5'
    branch: master
after_deploy:
  - cat $HOME/.pypirc
